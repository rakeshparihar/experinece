<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <title>GlamAR Web SDK – Clicks Fixed</title>

    <!-- Load GlamAR SDK -->
    <script src="https://cdn.glamar.io/sdk/wrapper"></script>

    <style>
      html,
      body {
        height: 100%;
        margin: 0;
      }
      body {
        font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      }
      #glamar-container {
        position: fixed;
        inset: 0;
        width: 100vw;
        height: 100vh;
        background: #fff;
        z-index: 1; /* SDK will create its own overlays; our toolbar will sit above them */
      }

      /* 🔥 Keep controls clickable above any SDK overlay */
      .toolbar {
        position: fixed;
        left: 0;
        right: 0;
        bottom: 0;
        display: flex;
        gap: 8px;
        padding: 12px;
        background: rgba(255, 255, 255, 0.92);
        backdrop-filter: blur(6px);
        border-top: 1px solid #eee;
        z-index: 2147483647; /* max practical z-index */
        pointer-events: auto;
      }
      .toolbar button {
        padding: 10px 14px;
        border-radius: 10px;
        border: 1px solid #e2e8f0;
        font-weight: 600;
        cursor: pointer;
      }
      .toolbar button:hover {
        background: #f7f7f7;
      }
    </style>
  </head>
  <body>
    <div id="glamar-container"></div>

    <div class="toolbar" role="toolbar" aria-label="GlamAR Controls">
      <button id="btnOpen" type="button">Open Live</button>
      <button id="btnApplySku" type="button">Apply SKU</button>
      <button id="btnApplyCategory" type="button">Apply Category</button>
      <button id="btnClose" type="button">Close</button>
    </div>

    <script>
      // ======= Fill these with real values =======
      const ACCESS_KEY = "2d5e01fd-2130-4b70-9071-f11ed3faec1b";
      const DEFAULT_CATEGORY = "sunglasses";
      const SAMPLE_SKU = "AC000932039S26";
      // ==========================================

      // Basic sanity
      if (!ACCESS_KEY) console.error("GlamAR: ACCESS_KEY missing.");

      document.addEventListener("DOMContentLoaded", () => {
        const options = {
          platform: "web",
          category: DEFAULT_CATEGORY,
          configuration: {
            global: {
              // OPTION A: auto-open camera on init
              openLiveOnInit: true,

              // OPTION B: manual open (uncomment next line and set openLiveOnInit: false)
              // openLiveOnInit: false,

              disableClose: false,
              disableBack: false,
            },
            ui: {
              loader: {
                disable: false,
              },
              watermark: { text: "", fontColor: "", logo: "" },
            },
            ar: { disable3DUI: false },
          },
          meta: { sdkVersion: "2.0.0" }, // optional, for diagnostics
          // NOTE: no 'meta' block; it's not part of the documented Web config
        };

        // Init
        window.GlamAR.init("glamar-container", ACCESS_KEY, options);

        // Diagnostics
        window.GlamAR.addEventListener("*", (e, payload) => {
          console.log("[GlamAR]", e, payload || "");
        });
        window.GlamAR.addEventListener("error", (err) => {
          console.error("SDK error:", err);
        });

        // Apply SKU when ready
        window.GlamAR.addEventListener("loaded", () => {
          console.log("SDK loaded — applying default SKU…");
          if (typeof GlamAR.applyBySku === "function") {
            GlamAR.applyBySku(SAMPLE_SKU);
          }
        });

        window.GlamAR.addEventListener("sku-applied", (p) => {
          console.log("✅ SKU applied", p);
        });
        window.GlamAR.addEventListener("sku-failed", (p) => {
          console.warn("❌ SKU failed", p);
        });

        // Toolbar actions — explicit event listeners
        document.getElementById("btnOpen").addEventListener("click", (e) => {
          e.stopPropagation();
          if (typeof GlamAR.open === "function") GlamAR.open();
        });

        document
          .getElementById("btnApplySku")
          .addEventListener("click", (e) => {
            e.stopPropagation();
            if (typeof GlamAR.applyBySku === "function")
              GlamAR.applyBySku(SAMPLE_SKU);
          });

        document
          .getElementById("btnApplyCategory")
          .addEventListener("click", (e) => {
            e.stopPropagation();
            if (typeof GlamAR.applyByCategory === "function")
              GlamAR.applyByCategory(DEFAULT_CATEGORY);
          });

        document.getElementById("btnClose").addEventListener("click", (e) => {
          e.stopPropagation();
          if (typeof GlamAR.close === "function") GlamAR.close();
        });
      });
    </script>
  </body>
</html>
