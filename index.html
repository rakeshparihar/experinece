<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <title>GlamAR Web SDK</title>
    <script src="https://cdn.glamar.io/sdk/wrapper" defer></script>

    <style>
      html,
      body {
        height: 100%;
        margin: 0;
      }
      body {
        font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      }
      #glamar-container {
        position: fixed;
        inset: 0;
        width: 100vw;
        height: 100vh;
        background: #fff;
        z-index: 1; /* SDK will create its own overlays; our toolbar will sit above them */
      }

      /* ðŸ”¥ Keep controls clickable above any SDK overlay */
      .toolbar {
        position: fixed;
        left: 0;
        right: 0;
        bottom: 0;
        display: flex;
        gap: 8px;
        padding: 12px;
        background: rgba(255, 255, 255, 0.92);
        backdrop-filter: blur(6px);
        border-top: 1px solid #eee;
        z-index: 2147483647; /* max practical z-index */
        pointer-events: auto;
      }
      .toolbar button {
        padding: 10px 14px;
        border-radius: 10px;
        border: 1px solid #e2e8f0;
        font-weight: 600;
        cursor: pointer;
      }
      .toolbar button:hover {
        background: #f7f7f7;
      }
    </style>
  </head>
  <body>
    <div id="glamar-container"></div>
    <div class="toolbar" role="toolbar" aria-label="GlamAR Controls">
      <button id="btnOpen" type="button">Open Live</button>
      <button id="btnApplySku" type="button">Apply SKU</button>
      <button id="btnApplyCategory" type="button">Apply Category</button>
      <button id="btnClose" type="button">Close</button>
    </div>

    <script>
      const ACCESS_KEY = "2d5e01fd-2130-4b70-9071-f11ed3faec1b";
      const DEFAULT_CATEGORY = "sunglasses";
      const SAMPLE_SKU = "AC000932039S26";

      let glamarSDK = null;

      async function initSDK() {
        const options = {
          platform: "web",
          category: DEFAULT_CATEGORY,
          configuration: {
            global: {
              openLiveOnInit: false,
              disableClose: false,
              disableBack: false,
            },
            ui: {
              loader: { disable: false },
              watermark: { text: "", fontColor: "", logo: "" },
            },
            ar: { disable3DUI: false },
          },
          meta: {
            sdkversion: "2.0.0",
          },
        };

        try {
          glamarSDK = await window.GlamAR.init(
            "glamar-container",
            ACCESS_KEY,
            options
          );
          console.log("SDK initialized");
          setupEventListeners();
        } catch (error) {
          console.error("SDK initialization failed:", error);
        }
      }

      function setupEventListeners() {
        window.GlamAR.addEventListener("loaded", () => {
          console.log("SDK loaded");
        });

        window.GlamAR.addEventListener("ready", () => {
          console.log("SDK ready");
        });

        window.GlamAR.addEventListener("error", (error) => {
          console.error("SDK error:", error);
        });

        document
          .getElementById("btnOpen")
          .addEventListener("click", async () => {
            try {
              await window.GlamAR.open();
              console.log("Camera opened");
            } catch (error) {
              console.error("Failed to open camera:", error);
            }
          });

        document
          .getElementById("btnApplySku")
          .addEventListener("click", async () => {
            try {
              await window.GlamAR.applyBySku(SAMPLE_SKU);
              console.log("SKU applied");
            } catch (error) {
              console.error("Failed to apply SKU:", error);
            }
          });

        document
          .getElementById("btnApplyCategory")
          .addEventListener("click", async () => {
            try {
              await window.GlamAR.applyByCategory(DEFAULT_CATEGORY);
              console.log("Category applied");
            } catch (error) {
              console.error("Failed to apply category:", error);
            }
          });

        document
          .getElementById("btnClose")
          .addEventListener("click", async () => {
            try {
              await window.GlamAR.close();
              console.log("Camera closed");
            } catch (error) {
              console.error("Failed to close camera:", error);
            }
          });
      }

      // Initialize when DOM is ready
      if (document.readyState === "loading") {
        document.addEventListener("DOMContentLoaded", initSDK);
      } else {
        initSDK();
      }
    </script>
  </body>
</html>
